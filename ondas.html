

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Ondas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6A11CB 0%, #2575FC 100%);
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .control-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .simulation-area {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }
        .input-group {
            margin-bottom: 20px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        .input-group input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .input-group input[type="number"]:focus {
            outline: none;
            border-color: #6A11CB;
        }
        .wave-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        .wave-card {
            background: #f7fafc;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .wave-card:hover {
            border-color: #6A11CB;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .wave-card.selected {
            background: #eef2ff;
            border-color: #6A11CB;
        }
        .wave-icon {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        .wave-name {
            font-weight: 600;
            color: #333;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 100px;
        }
        .btn-primary {
            background: #6A11CB;
            color: white;
        }
        .btn-primary:hover {
            background: #5a0fb8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }
        .btn-secondary {
            background: #f7fafc;
            color: #6A11CB;
            border: 2px solid #6A11CB;
        }
        .btn-secondary:hover {
            background: #6A11CB;
            color: white;
        }
        .btn-danger {
            background: #e53e3e;
            color: white;
        }
        .btn-danger:hover {
            background: #c53030;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(229, 62, 62, 0.4);
        }
        .slider-container {
            margin-bottom: 20px;
        }
        .slider-container label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #6A11CB;
            cursor: pointer;
        }
        .info-panel {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .info-panel h3 {
            color: #6A11CB;
            margin-bottom: 10px;
        }
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .info-item:last-child {
            border-bottom: none;
        }
        .info-value {
            font-weight: 600;
            color: #333;
        }
        #canvas {
            width: 100%;
            height: 400px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #f8f9fa;
            margin-bottom: 20px;
        }
        .simulation-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .charts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .chart-container h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #6A11CB;
        }
        .chart {
            width: 100%;
            height: 250px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .experiments-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .experiment-card {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .experiment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #6A11CB;
        }
        .experiment-card.active {
            background: #eef2ff;
            border-color: #6A11CB;
        }
        .experiment-card h4 {
            color: #6A11CB;
            margin-bottom: 10px;
        }
        .theory-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .theory-section h2 {
            color: #6A11CB;
            margin-bottom: 15px;
        }
        .formula {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 15px 0;
            border-left: 4px solid #6A11CB;
        }
        .challenge-section {
            background: #fef3c7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid #f59e0b;
        }
        .challenge-section h3 {
            color: #d97706;
            margin-bottom: 10px;
        }
        .challenge-question {
            margin-bottom: 15px;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        .challenge-options {
            margin-bottom: 15px;
        }
        .challenge-option {
            background: white;
            border: 2px solid #f59e0b;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .challenge-option:hover {
            background: #fffbeb;
            transform: translateX(5px);
        }
        .challenge-option.selected {
            background: #fbbf24;
            border-color: #d97706;
            font-weight: 600;
        }
        .challenge-option.correct {
            background: #d1fae5;
            border-color: #10b981;
        }
        .challenge-option.incorrect {
            background: #fee2e2;
            border-color: #ef4444;
        }
        .challenge-answer {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            border: 2px solid #48bb78;
        }
        .challenge-answer.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .challenge-answer h4 {
            color: #48bb78;
            margin-bottom: 10px;
        }
        .challenge-feedback {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }
        .challenge-feedback.show {
            display: block;
        }
        .challenge-feedback.correct {
            border: 2px solid #48bb78;
            color: #48bb78;
        }
        .challenge-feedback.incorrect {
            border: 2px solid #e53e3e;
            color: #e53e3e;
        }
        .phenomenon-panel {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .phenomenon-panel h3 {
            color: #6A11CB;
            margin-bottom: 15px;
        }
        .phenomenon-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        .phenomenon-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .phenomenon-card:hover {
            border-color: #6A11CB;
            transform: translateY(-2px);
        }
        .phenomenon-card.active {
            background: #eef2ff;
            border-color: #6A11CB;
            font-weight: 600;
        }
        .wave-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .wave-panel {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
        }
        .wave-panel h4 {
            color: #6A11CB;
            margin-bottom: 10px;
            text-align: center;
        }
        .simulation-title {
            color: #6A11CB;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
        }
        .challenge-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .wave-medium-selector {
            margin-bottom: 20px;
        }
        .wave-medium-selector select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s;
        }
        .wave-medium-selector select:focus {
            outline: none;
            border-color: #6A11CB;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1000;
            max-width: 400px;
        }
        .notification.show {
            transform: translateX(0);
        }
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            .charts-section {
                grid-template-columns: 1fr;
            }
            header h1 {
                font-size: 2rem;
            }
            .controls {
                flex-direction: column;
            }
            button {
                width: 100%;
            }
            .wave-selector {
                grid-template-columns: 1fr;
            }
            .simulation-controls {
                flex-direction: column;
            }
            .phenomenon-options {
                grid-template-columns: 1fr;
            }
            .wave-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🌊 Simulador de Ondas</h1>
            <p>Explore os princípios fundamentais das ondas e seus fenômenos</p>
        </header>
        
        <section class="theory-section">
            <h2>📚 Fundamentos das Ondas</h2>
            <p>Uma onda é uma perturbação que se propaga através de um espaço ou meio, transportando energia sem transportar matéria. As ondas podem ser classificadas de acordo com sua natureza, direção de vibração e meio de propagação.</p>
            
            <div class="formula">
                v = λ·f &nbsp;&nbsp;&nbsp;&nbsp; T = 1/f
            </div>
            
            <p>Onde:</p>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>v</strong> = Velocidade de propagação (m/s)</li>
                <li><strong>λ</strong> = Comprimento de onda (m)</li>
                <li><strong>f</strong> = Frequência (Hz)</li>
                <li><strong>T</strong> = Período (s)</li>
            </ul>
            
            <p style="margin-top: 15px;"><strong>Tipos de ondas:</strong></p>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>Ondas Mecânicas:</strong> Necessitam de um meio material para se propagar (ex: som, ondas na água).</li>
                <li><strong>Ondas Eletromagnéticas:</strong> Propagam-se no vácuo (ex: luz, ondas de rádio).</li>
                <li><strong>Ondas Longitudinais:</strong> A direção de vibração é paralela à direção de propagação (ex: som).</li>
                <li><strong>Ondas Transversais:</strong> A direção de vibração é perpendicular à direção de propagação (ex: ondas em uma corda).</li>
            </ul>
        </section>
        
        <div class="main-content">
            <div class="control-panel">
                <h3>📊 Parâmetros da Onda</h3>
                
                <div class="wave-comparison">
                    <div class="wave-panel">
                        <h4>Onda 1</h4>
                        <div class="wave-selector">
                            <div class="wave-card selected" data-wave="transverse" data-target="1">
                                <div class="wave-icon">〰️</div>
                                <div class="wave-name">Transversal</div>
                            </div>
                            <div class="wave-card" data-wave="longitudinal" data-target="1">
                                <div class="wave-icon">↔️</div>
                                <div class="wave-name">Longitudinal</div>
                            </div>
                        </div>
                        
                        <div class="wave-medium-selector">
                            <label>Meio de Propagação:</label>
                            <select id="medium1">
                                <option value="air">Ar</option>
                                <option value="water">Água</option>
                                <option value="string">Corda</option>
                                <option value="vacuum">Vácuo</option>
                            </select>
                        </div>
                        
                        <div class="slider-container">
                            <label for="amplitude1">Amplitude: <span id="amplitudeValue1">20</span> px</label>
                            <input type="range" id="amplitude1" min="5" max="50" step="1" value="20">
                        </div>
                        
                        <div class="slider-container">
                            <label for="frequency1">Frequência: <span id="frequencyValue1">2</span> Hz</label>
                            <input type="range" id="frequency1" min="0.5" max="5" step="0.1" value="2">
                        </div>
                        
                        <div class="slider-container">
                            <label for="wavelength1">Comprimento de Onda: <span id="wavelengthValue1">100</span> px</label>
                            <input type="range" id="wavelength1" min="50" max="200" step="5" value="100">
                        </div>
                    </div>
                    
                    <div class="wave-panel">
                        <h4>Onda 2</h4>
                        <div class="wave-selector">
                            <div class="wave-card selected" data-wave="transverse" data-target="2">
                                <div class="wave-icon">〰️</div>
                                <div class="wave-name">Transversal</div>
                            </div>
                            <div class="wave-card" data-wave="longitudinal" data-target="2">
                                <div class="wave-icon">↔️</div>
                                <div class="wave-name">Longitudinal</div>
                            </div>
                        </div>
                        
                        <div class="wave-medium-selector">
                            <label>Meio de Propagação:</label>
                            <select id="medium2">
                                <option value="air">Ar</option>
                                <option value="water">Água</option>
                                <option value="string">Corda</option>
                                <option value="vacuum">Vácuo</option>
                            </select>
                        </div>
                        
                        <div class="slider-container">
                            <label for="amplitude2">Amplitude: <span id="amplitudeValue2">20</span> px</label>
                            <input type="range" id="amplitude2" min="5" max="50" step="1" value="20">
                        </div>
                        
                        <div class="slider-container">
                            <label for="frequency2">Frequência: <span id="frequencyValue2">2</span> Hz</label>
                            <input type="range" id="frequency2" min="0.5" max="5" step="0.1" value="2">
                        </div>
                        
                        <div class="slider-container">
                            <label for="wavelength2">Comprimento de Onda: <span id="wavelengthValue2">100</span> px</label>
                            <input type="range" id="wavelength2" min="50" max="200" step="5" value="100">
                        </div>
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="waveSuperposition">
                    <label for="waveSuperposition">Sobreposição de Ondas</label>
                </div>
                
                <div class="phenomenon-panel">
                    <h3>Fenômenos Ondulatórios</h3>
                    <div class="phenomenon-options">
                        <div class="phenomenon-card" data-phenomenon="reflection">
                            🔄 Reflexão
                        </div>
                        <div class="phenomenon-card" data-phenomenon="refraction">
                            🔀 Refração
                        </div>
                        <div class="phenomenon-card" data-phenomenon="diffraction">
                            🌀 Difração
                        </div>
                        <div class="phenomenon-card" data-phenomenon="interference">
                            ⚡ Interferência
                        </div>
                    </div>
                </div>
                
                <div class="info-panel">
                    <h3>📊 Dados Calculados</h3>
                    <div class="info-item">
                        <span>Velocidade Onda 1:</span>
                        <span class="info-value" id="velocity1">200 px/s</span>
                    </div>
                    <div class="info-item">
                        <span>Período Onda 1:</span>
                        <span class="info-value" id="period1">0.5 s</span>
                    </div>
                    <div class="info-item">
                        <span>Velocidade Onda 2:</span>
                        <span class="info-value" id="velocity2">200 px/s</span>
                    </div>
                    <div class="info-item">
                        <span>Período Onda 2:</span>
                        <span class="info-value" id="period2">0.5 s</span>
                    </div>
                </div>
                
                <div class="challenge-section">
                    <h3>🎯 Desafio do Professor</h3>
                    <div class="challenge-question" id="challengeText">
                        Se duas ondas com a mesma frequência e amplitude estão em fase, o que acontece quando elas se encontram?
                    </div>
                    
                    <div class="challenge-options" id="challengeOptions">
                        <div class="challenge-option" data-answer="a">Elas se anulam completamente</div>
                        <div class="challenge-option" data-answer="b">Elas se somam, criando uma onda com amplitude dobrada</div>
                        <div class="challenge-option" data-answer="c">Elas continuam sem se afetar</div>
                        <div class="challenge-option" data-answer="d">Elas mudam de frequência</div>
                    </div>
                    
                    <div class="challenge-feedback" id="challengeFeedback"></div>
                    
                    <div class="challenge-answer" id="challengeAnswer">
                        <h4>✅ Resposta Correta!</h4>
                        <p><strong>Explicação:</strong> Quando duas ondas com a mesma frequência e amplitude estão em fase (ou seja, seus picos e vales coincidem), ocorre o que chamamos de interferência construtiva. Nesse caso, as amplitudes das duas ondas se somam, resultando em uma onda com amplitude dobrada. Este é um princípio fundamental da física ondulatória e explica fenômenos como as ondas estacionárias e os padrões de interferência.</p>
                    </div>
                    
                    <div class="challenge-controls">
                        <button class="btn-primary" id="submitAnswerBtn">Enviar Resposta</button>
                        <button class="btn-secondary" id="nextChallengeBtn" style="display: none;">Próximo Desafio</button>
                    </div>
                </div>
            </div>
            
            <div class="simulation-area">
                <h3 class="simulation-title">🎮 Controles da Simulação</h3>
                
                <div class="simulation-controls">
                    <button class="btn-primary" id="startBtn">▶️ Iniciar</button>
                    <button class="btn-secondary" id="pauseBtn">⏸️ Pausar</button>
                    <button class="btn-danger" id="resetBtn">🔄 Resetar</button>
                    <button class="btn-secondary" id="newWaveBtn">➕ Gerar Nova Onda</button>
                </div>
                
                <h3>🎬 Simulação Visual</h3>
                <canvas id="canvas"></canvas>
                
                <div class="info-panel">
                    <h3>📊 Informações da Simulação</h3>
                    <div class="info-item">
                        <span>Sobreposição de ondas:</span>
                        <span class="info-value" id="simSuperposition">Desativada</span>
                    </div>
                    <div class="info-item">
                        <span>Fenômeno ativo:</span>
                        <span class="info-value" id="simPhenomenon">Nenhum</span>
                    </div>
                    <div class="info-item">
                        <span>Meio Onda 1:</span>
                        <span class="info-value" id="simMedium1">Ar</span>
                    </div>
                    <div class="info-item">
                        <span>Meio Onda 2:</span>
                        <span class="info-value" id="simMedium2">Ar</span>
                    </div>
                </div>
            </div>
        </div>
        
        <section class="charts-section">
            <div class="chart-container">
                <h3>📈 Amplitude × Posição</h3>
                <canvas class="chart" id="amplitudeChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h3>📊 Frequência × Comprimento de Onda</h3>
                <canvas class="chart" id="frequencyChart"></canvas>
            </div>
            
            <div class="chart-container">
                <h3>⚡ Velocidade × Meio</h3>
                <canvas class="chart" id="velocityChart"></canvas>
            </div>
        </section>
        
        <section class="experiments-section">
            <h3>🧪 Experimentos Guiados</h3>
            
            <div class="experiment-card" data-experiment="1">
                <h4>Experimento 1: Relação entre frequência e comprimento de onda</h4>
                <p>Mantenha a velocidade constante e varie a frequência de uma onda. Observe como o comprimento de onda muda inversamente à frequência, confirmando a relação v = λ·f. Tente diferentes valores e anote suas observações.</p>
            </div>
            
            <div class="experiment-card" data-experiment="2">
                <h4>Experimento 2: Interferência construtiva e destrutiva</h4>
                <p>Ative a sobreposição de ondas e configure duas ondas com a mesma frequência e amplitude. Primeiro, deixe-as em fase (interferência construtiva) e depois, mude uma delas para ficar fora de fase (interferência destrutiva). Compare os resultados.</p>
            </div>
            
            <div class="experiment-card" data-experiment="3">
                <h4>Experimento 3: Reflexão de ondas</h4>
                <p>Ative o fenômeno de reflexão e observe como uma onda se comporta quando encontra um obstáculo. Tente diferentes ângulos de incidência e observe o ângulo de reflexão. O que você pode concluir?</p>
            </div>
            
            <div class="experiment-card" data-experiment="4">
                <h4>Experimento 4: Propagação em diferentes meios</h4>
                <p>Mantenha os parâmetros da onda constantes, mas altere o meio de propagação (ar, água, corda, vácuo). Observe como a velocidade da onda muda em cada meio e como isso afeta o comprimento de onda.</p>
            </div>
        </section>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // Classe principal da simulação de ondas
        class WaveSimulation {
            constructor() {
                this.canvas = document.getElementById('canvas');
                this.ctx = this.canvas.getContext('2d');
                
                // Propriedades das ondas
                this.waves = [
                    {
                        id: 1,
                        type: 'transverse',
                        medium: 'air',
                        amplitude: 20,
                        frequency: 2,
                        wavelength: 100,
                        color: '#FF6B6B',
                        phase: 0,
                        velocity: 0,
                        period: 0
                    },
                    {
                        id: 2,
                        type: 'transverse',
                        medium: 'air',
                        amplitude: 20,
                        frequency: 2,
                        wavelength: 100,
                        color: '#4ECDC4',
                        phase: 0,
                        velocity: 0,
                        period: 0
                    }
                ];
                
                // Configurações da simulação
                this.waveSuperposition = false;
                this.activePhenomenon = null;
                this.time = 0;
                
                // Estado da simulação
                this.isRunning = false;
                this.isPaused = false;
                
                // Propriedades dos meios
                this.mediumProperties = {
                    air: { name: 'Ar', velocityFactor: 1, color: '#E3F2FD' },
                    water: { name: 'Água', velocityFactor: 0.25, color: '#E1F5FE' },
                    string: { name: 'Corda', velocityFactor: 0.5, color: '#FFF8E1' },
                    vacuum: { name: 'Vácuo', velocityFactor: 3, color: '#F3E5F5' }
                };
                
                // Configurar canvas e event listeners
                this.setupCanvas();
                this.setupEventListeners();
                this.setupCharts();
                
                // Configurar desafios
                this.setupChallenges();
                this.currentChallenge = 0;
                this.selectedAnswer = null;
                this.challengeAnswered = false;
                
                // Calcular valores iniciais
                this.updateWaveProperties();
                
                // Garantir que o canvas seja renderizado corretamente após o carregamento
                setTimeout(() => {
                    this.setupCanvas();
                    this.updateDisplay();
                    this.draw();
                }, 100);
            }
            
            setupCanvas() {
                const rect = this.canvas.getBoundingClientRect();
                this.canvas.width = rect.width;
                this.canvas.height = rect.height;
            }
            
            setupEventListeners() {
                // Event listener para redimensionamento da janela
                window.addEventListener('resize', () => {
                    this.setupCanvas();
                    this.updateDisplay();
                    this.draw();
                });
                
                // Seletores de tipo de onda
                document.querySelectorAll('.wave-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const target = parseInt(card.dataset.target);
                        const waveType = card.dataset.wave;
                        
                        // Remover seleção anterior
                        document.querySelectorAll(`.wave-card[data-target="${target}"]`).forEach(c => {
                            c.classList.remove('selected');
                        });
                        
                        // Adicionar seleção ao tipo clicado
                        card.classList.add('selected');
                        
                        // Atualizar tipo de onda na simulação
                        this.waves[target - 1].type = waveType;
                        this.updateDisplay();
                        this.draw();
                    });
                });
                
                // Meios de propagação
                document.getElementById('medium1').addEventListener('change', (e) => {
                    this.waves[0].medium = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('medium2').addEventListener('change', (e) => {
                    this.waves[1].medium = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                // Sliders de amplitude, frequência e comprimento de onda
                document.getElementById('amplitude1').addEventListener('input', (e) => {
                    this.waves[0].amplitude = parseFloat(e.target.value);
                    document.getElementById('amplitudeValue1').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('frequency1').addEventListener('input', (e) => {
                    this.waves[0].frequency = parseFloat(e.target.value);
                    document.getElementById('frequencyValue1').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('wavelength1').addEventListener('input', (e) => {
                    this.waves[0].wavelength = parseFloat(e.target.value);
                    document.getElementById('wavelengthValue1').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('amplitude2').addEventListener('input', (e) => {
                    this.waves[1].amplitude = parseFloat(e.target.value);
                    document.getElementById('amplitudeValue2').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('frequency2').addEventListener('input', (e) => {
                    this.waves[1].frequency = parseFloat(e.target.value);
                    document.getElementById('frequencyValue2').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                document.getElementById('wavelength2').addEventListener('input', (e) => {
                    this.waves[1].wavelength = parseFloat(e.target.value);
                    document.getElementById('wavelengthValue2').textContent = e.target.value;
                    this.updateWaveProperties();
                    this.updateDisplay();
                    this.draw();
                });
                
                // Sobreposição de ondas
                document.getElementById('waveSuperposition').addEventListener('change', (e) => {
                    this.waveSuperposition = e.target.checked;
                    const simSuperposition = document.getElementById('simSuperposition');
                    
                    if (this.waveSuperposition) {
                        simSuperposition.textContent = 'Ativada';
                    } else {
                        simSuperposition.textContent = 'Desativada';
                    }
                    
                    this.draw();
                });
                
                // Fenômenos ondulatórios
                document.querySelectorAll('.phenomenon-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const phenomenon = card.dataset.phenomenon;
                        
                        // Remover seleção anterior
                        document.querySelectorAll('.phenomenon-card').forEach(c => {
                            c.classList.remove('active');
                        });
                        
                        // Se o mesmo fenômeno foi clicado novamente, desativar
                        if (this.activePhenomenon === phenomenon) {
                            this.activePhenomenon = null;
                            document.getElementById('simPhenomenon').textContent = 'Nenhum';
                        } else {
                            // Ativar novo fenômeno
                            card.classList.add('active');
                            this.activePhenomenon = phenomenon;
                            
                            // Mapear nomes dos fenômenos
                            const phenomenonNames = {
                                reflection: 'Reflexão',
                                refraction: 'Refração',
                                diffraction: 'Difração',
                                interference: 'Interferência'
                            };
                            
                            document.getElementById('simPhenomenon').textContent = phenomenonNames[phenomenon];
                        }
                        
                        this.draw();
                    });
                });
                
                // Botões
                document.getElementById('startBtn').addEventListener('click', () => this.start());
                document.getElementById('pauseBtn').addEventListener('click', () => this.pause());
                document.getElementById('resetBtn').addEventListener('click', () => this.reset());
                document.getElementById('newWaveBtn').addEventListener('click', () => this.generateNewWave());
                
                // Experimentos
                document.querySelectorAll('.experiment-card').forEach(card => {
                    card.addEventListener('click', () => {
                        document.querySelectorAll('.experiment-card').forEach(c => c.classList.remove('active'));
                        card.classList.add('active');
                        this.loadExperiment(parseInt(card.dataset.experiment));
                    });
                });
                
                // Desafio
                document.getElementById('submitAnswerBtn').addEventListener('click', () => this.submitChallengeAnswer());
                document.getElementById('nextChallengeBtn').addEventListener('click', () => this.nextChallenge());
            }
            
            setupCharts() {
                // Configurar gráficos
                this.amplitudeChart = document.getElementById('amplitudeChart');
                this.amplitudeCtx = this.amplitudeChart.getContext('2d');
                
                this.frequencyChart = document.getElementById('frequencyChart');
                this.frequencyCtx = this.frequencyChart.getContext('2d');
                
                this.velocityChart = document.getElementById('velocityChart');
                this.velocityCtx = this.velocityChart.getContext('2d');
                
                // Ajustar tamanho dos gráficos
                [this.amplitudeChart, this.frequencyChart, this.velocityChart].forEach(chart => {
                    const rect = chart.getBoundingClientRect();
                    chart.width = rect.width;
                    chart.height = rect.height;
                });
                
                // Desenhar gráficos iniciais
                this.drawCharts();
            }
            
            setupChallenges() {
                this.challenges = [
                    {
                        question: "Se duas ondas com a mesma frequência e amplitude estão em fase, o que acontece quando elas se encontram?",
                        options: [
                            "Elas se anulam completamente",
                            "Elas se somam, criando uma onda com amplitude dobrada",
                            "Elas continuam sem se afetar",
                            "Elas mudam de frequência"
                        ],
                        correctAnswer: "b",
                        explanation: "Quando duas ondas com a mesma frequência e amplitude estão em fase (ou seja, seus picos e vales coincidem), ocorre o que chamamos de interferência construtiva. Nesse caso, as amplitudes das duas ondas se somam, resultando em uma onda com amplitude dobrada. Este é um princípio fundamental da física ondulatória e explica fenômenos como as ondas estacionárias e os padrões de interferência."
                    },
                    {
                        question: "O que acontece com o comprimento de onda quando uma onda passa de um meio menos denso para um meio mais denso?",
                        options: [
                            "O comprimento de onda aumenta",
                            "O comprimento de onda diminui",
                            "O comprimento de onda permanece o mesmo",
                            "O comprimento de onda se torna zero"
                        ],
                        correctAnswer: "b",
                        explanation: "Quando uma onda passa de um meio menos denso para um meio mais denso, sua velocidade diminui, mas a frequência permanece constante. Pela equação v = λ·f, se v diminui e f permanece constante, então λ (comprimento de onda) também deve diminuir. Este fenômeno é conhecido como refração e é o que faz com que um objeto pareça 'quebrado' quando parcialmente submerso na água."
                    },
                    {
                        question: "Qual fenômeno ondulatório explica o fato de podermos ouvir sons ao redor de um obstáculo, mesmo sem estar na linha direta de visão da fonte sonora?",
                        options: [
                            "Reflexão",
                            "Refração",
                            "Difração",
                            "Interferência"
                        ],
                        correctAnswer: "c",
                        explanation: "A difração é o fenômeno que explica como as ondas podem contornar obstáculos. Quando uma onda encontra um obstáculo com dimensões comparáveis ao seu comprimento de onda, ela se espalha ou 'dobra' nas bordas do obstáculo. No caso do som, como os comprimentos de onda sonoros são relativamente grandes (de centímetros a metros), a difração é facilmente observada, permitindo que ouçamos sons ao redor de cantos e obstáculos."
                    },
                    {
                        question: "Se dobrarmos a frequência de uma onda, mantendo constante sua velocidade de propagação, o que acontece com o comprimento de onda?",
                        options: [
                            "O comprimento de onda dobra",
                            "O comprimento de onda permanece o mesmo",
                            "O comprimento de onda é reduzido à metade",
                            "O comprimento de onda quadruplica"
                        ],
                        correctAnswer: "c",
                        explanation: "Pela equação fundamental das ondas v = λ·f, se mantivermos a velocidade (v) constante e dobrarmos a frequência (f), então o comprimento de onda (λ) deve ser reduzido à metade para manter a igualdade. Esta relação inversa entre frequência e comprimento de onda é fundamental para entender muitos fenômenos ondulatórios."
                    },
                    {
                        question: "Ondas eletromagnéticas diferem das ondas mecânicas principalmente porque:",
                        options: [
                            "Têm maior frequência",
                            "São transversais",
                            "Não necessitam de um meio material para se propagar",
                            "Têm maior amplitude"
                        ],
                        correctAnswer: "c",
                        explanation: "A principal diferença entre ondas eletromagnéticas (como a luz) e ondas mecânicas (como o som) é que as ondas eletromagnéticas não necessitam de um meio material para se propagar. Elas podem se propagar no vácuo, enquanto as ondas mecânicas exigem um meio (sólido, líquido ou gasoso) para se propagar. É por isso que podemos ver a luz das estrelas, mas não podemos ouvir sons do espaço."
                    }
                ];
                
                // Adicionar event listeners para as opções do desafio
                document.querySelectorAll('.challenge-option').forEach(option => {
                    option.addEventListener('click', () => {
                        if (this.challengeAnswered) return;
                        
                        // Remover seleção anterior
                        document.querySelectorAll('.challenge-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Adicionar seleção à opção clicada
                        option.classList.add('selected');
                        this.selectedAnswer = option.dataset.answer;
                    });
                });
                
                // Carregar primeiro desafio
                this.loadChallenge(0);
            }
            
            loadChallenge(index) {
                const challenge = this.challenges[index];
                document.getElementById('challengeText').textContent = challenge.question;
                
                const optionsContainer = document.getElementById('challengeOptions');
                optionsContainer.innerHTML = '';
                
                const optionLetters = ['a', 'b', 'c', 'd'];
                challenge.options.forEach((option, i) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'challenge-option';
                    optionElement.dataset.answer = optionLetters[i];
                    optionElement.textContent = option;
                    
                    optionElement.addEventListener('click', () => {
                        if (this.challengeAnswered) return;
                        
                        // Remover seleção anterior
                        document.querySelectorAll('.challenge-option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Adicionar seleção à opção clicada
                        optionElement.classList.add('selected');
                        this.selectedAnswer = optionLetters[i];
                    });
                    
                    optionsContainer.appendChild(optionElement);
                });
                
                // Resetar estado do desafio
                this.selectedAnswer = null;
                this.challengeAnswered = false;
                document.getElementById('challengeAnswer').classList.remove('show');
                document.getElementById('challengeFeedback').classList.remove('show');
                document.getElementById('submitAnswerBtn').style.display = 'block';
                document.getElementById('nextChallengeBtn').style.display = 'none';
            }
            
            submitChallengeAnswer() {
                if (!this.selectedAnswer) {
                    this.showNotification('Por favor, selecione uma resposta antes de enviar', 'warning');
                    return;
                }
                
                this.challengeAnswered = true;
                const challenge = this.challenges[this.currentChallenge];
                const feedbackElement = document.getElementById('challengeFeedback');
                const answerElement = document.getElementById('challengeAnswer');
                
                // Verificar se a resposta está correta
                const isCorrect = this.selectedAnswer === challenge.correctAnswer;
                
                // Mostrar feedback
                feedbackElement.classList.add('show');
                if (isCorrect) {
                    feedbackElement.className = 'challenge-feedback correct show';
                    feedbackElement.textContent = '✅ Resposta correta! Parabéns!';
                } else {
                    feedbackElement.className = 'challenge-feedback incorrect show';
                    feedbackElement.textContent = '❌ Resposta incorreta. Tente novamente ou veja a explicação.';
                }
                
                // Destacar opções corretas e incorretas
                document.querySelectorAll('.challenge-option').forEach(option => {
                    if (option.dataset.answer === challenge.correctAnswer) {
                        option.classList.add('correct');
                    } else if (option.dataset.answer === this.selectedAnswer && !isCorrect) {
                        option.classList.add('incorrect');
                    }
                });
                
                // Mostrar explicação
                answerElement.querySelector('p').innerHTML = `<strong>Explicação:</strong> ${challenge.explanation}`;
                answerElement.classList.add('show');
                
                // Atualizar botões
                document.getElementById('submitAnswerBtn').style.display = 'none';
                document.getElementById('nextChallengeBtn').style.display = 'block';
                
                // Notificação
                if (isCorrect) {
                    this.showNotification('Resposta correta! Ótimo trabalho!', 'success');
                } else {
                    this.showNotification('Resposta incorreta. Estude a explicação para aprender mais.', 'error');
                }
            }
            
            nextChallenge() {
                // Avançar para o próximo desafio
                this.currentChallenge = (this.currentChallenge + 1) % this.challenges.length;
                this.loadChallenge(this.currentChallenge);
                this.showNotification(`Carregando desafio ${this.currentChallenge + 1} de ${this.challenges.length}`, 'info');
            }
            
            updateWaveProperties() {
                this.waves.forEach(wave => {
                    // Calcular velocidade (v = λ·f)
                    wave.velocity = wave.wavelength * wave.frequency;
                    
                    // Aplicar fator do meio
                    const mediumFactor = this.mediumProperties[wave.medium].velocityFactor;
                    wave.velocity *= mediumFactor;
                    
                    // Calcular período (T = 1/f)
                    wave.period = 1 / wave.frequency;
                });
                
                // Atualizar display
                document.getElementById('velocity1').textContent = this.waves[0].velocity.toFixed(0) + ' px/s';
                document.getElementById('period1').textContent = this.waves[0].period.toFixed(2) + ' s';
                document.getElementById('velocity2').textContent = this.waves[1].velocity.toFixed(0) + ' px/s';
                document.getElementById('period2').textContent = this.waves[1].period.toFixed(2) + ' s';
                
                // Atualizar meios na simulação
                document.getElementById('simMedium1').textContent = this.mediumProperties[this.waves[0].medium].name;
                document.getElementById('simMedium2').textContent = this.mediumProperties[this.waves[1].medium].name;
            }
            
            start() {
                if (!this.isRunning) {
                    this.isRunning = true;
                    this.isPaused = false;
                    this.animate();
                    this.showNotification('Simulação iniciada!', 'success');
                }
            }
            
            pause() {
                if (this.isRunning && !this.isPaused) {
                    this.isPaused = true;
                    this.showNotification('Simulação pausada', 'info');
                } else if (this.isPaused) {
                    this.isPaused = false;
                    this.animate();
                    this.showNotification('Simulação retomada', 'info');
                }
            }
            
            reset() {
                this.isRunning = false;
                this.isPaused = false;
                this.time = 0;
                
                // Resetar fases
                this.waves.forEach(wave => {
                    wave.phase = 0;
                });
                
                this.updateDisplay();
                this.draw();
                this.drawCharts();
                this.showNotification('Simulação resetada', 'info');
            }
            
            generateNewWave() {
                // Gerar parâmetros aleatórios para a onda 2
                const newAmplitude = Math.floor(Math.random() * 40) + 10;
                const newFrequency = (Math.random() * 4 + 0.5).toFixed(1);
                const newWavelength = Math.floor(Math.random() * 150) + 50;
                
                // Atualizar onda 2
                this.waves[1].amplitude = newAmplitude;
                this.waves[1].frequency = parseFloat(newFrequency);
                this.waves[1].wavelength = newWavelength;
                
                // Atualizar UI
                document.getElementById('amplitude2').value = newAmplitude;
                document.getElementById('amplitudeValue2').textContent = newAmplitude;
                document.getElementById('frequency2').value = newFrequency;
                document.getElementById('frequencyValue2').textContent = newFrequency;
                document.getElementById('wavelength2').value = newWavelength;
                document.getElementById('wavelengthValue2').textContent = newWavelength;
                
                // Atualizar propriedades
                this.updateWaveProperties();
                this.updateDisplay();
                this.draw();
                this.drawCharts();
                
                this.showNotification('Nova onda gerada!', 'success');
            }
            
            animate() {
                if (!this.isRunning || this.isPaused) return;
                
                // Atualizar tempo
                this.time += 0.016; // 60 FPS
                
                // Atualizar fases
                this.waves.forEach(wave => {
                    wave.phase += 2 * Math.PI * wave.frequency * 0.016;
                });
                
                // Atualizar displays
                this.updateDisplay();
                this.draw();
                
                // Atualizar gráficos periodicamente
                if (Math.floor(this.time * 10) % 10 === 0) {
                    this.drawCharts();
                }
                
                // Continuar animação
                requestAnimationFrame(() => this.animate());
            }
            
            updateDisplay() {
                // A atualização dos valores é feita em updateWaveProperties
            }
            
            draw() {
                // Limpar canvas
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Desenhar fundo com base no meio
                const medium = this.mediumProperties[this.waves[0].medium];
                const gradient = this.ctx.createLinearGradient(0, 0, 0, this.canvas.height);
                gradient.addColorStop(0, medium.color);
                gradient.addColorStop(1, '#FFFFFF');
                
                this.ctx.fillStyle = gradient;
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Desenhar eixos
                this.ctx.strokeStyle = '#333';
                this.ctx.lineWidth = 1;
                this.ctx.beginPath();
                this.ctx.moveTo(0, this.canvas.height / 2);
                this.ctx.lineTo(this.canvas.width, this.canvas.height / 2);
                this.ctx.stroke();
                
                // Desenhar ondas
                const centerY = this.canvas.height / 2;
                
                // Desenhar onda 1
                this.drawWave(this.waves[0], centerY);
                
                // Desenhar onda 2
                this.drawWave(this.waves[1], centerY);
                
                // Desenhar sobreposição se ativada
                if (this.waveSuperposition) {
                    this.drawSuperposition(centerY);
                }
                
                // Desenhar fenômenos se ativados
                if (this.activePhenomenon) {
                    this.drawPhenomenon();
                }
                
                // Desenhar legendas
                this.drawLegends();
            }
            
            drawWave(wave, centerY) {
                this.ctx.strokeStyle = wave.color;
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                
                const points = [];
                
                for (let x = 0; x < this.canvas.width; x += 2) {
                    let y;
                    
                    if (wave.type === 'transverse') {
                        // Onda transversal: y = A * sin(2π * x/λ + φ)
                        y = centerY - wave.amplitude * Math.sin(2 * Math.PI * x / wave.wavelength + wave.phase);
                    } else {
                        // Onda longitudinal: representada por compressões e rarefações
                        const compression = Math.sin(2 * Math.PI * x / wave.wavelength + wave.phase);
                        y = centerY - compression * wave.amplitude * 0.5;
                    }
                    
                    points.push({x, y});
                    
                    if (x === 0) {
                        this.ctx.moveTo(x, y);
                    } else {
                        this.ctx.lineTo(x, y);
                    }
                }
                
                this.ctx.stroke();
                
                // Para ondas longitudinais, desenhar partículas
                if (wave.type === 'longitudinal') {
                    this.ctx.fillStyle = wave.color;
                    
                    for (let x = 0; x < this.canvas.width; x += 20) {
                        const displacement = 10 * Math.sin(2 * Math.PI * x / wave.wavelength + wave.phase);
                        this.ctx.beginPath();
                        this.ctx.arc(x + displacement, centerY, 3, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                }
            }
            
            drawSuperposition(centerY) {
                // Calcular pontos da sobreposição
                this.ctx.strokeStyle = '#9C27B0';
                this.ctx.lineWidth = 3;
                this.ctx.setLineDash([5, 5]);
                this.ctx.beginPath();
                
                for (let x = 0; x < this.canvas.width; x += 2) {
                    // Calcular posição de cada onda
                    const y1 = centerY - this.waves[0].amplitude * Math.sin(2 * Math.PI * x / this.waves[0].wavelength + this.waves[0].phase);
                    const y2 = centerY - this.waves[1].amplitude * Math.sin(2 * Math.PI * x / this.waves[1].wavelength + this.waves[1].phase);
                    
                    // Sobreposição: soma das amplitudes
                    const y = y1 + y2 - centerY;
                    
                    if (x === 0) {
                        this.ctx.moveTo(x, y);
                    } else {
                        this.ctx.lineTo(x, y);
                    }
                }
                
                this.ctx.stroke();
                this.ctx.setLineDash([]);
            }
            
            drawPhenomenon() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                switch(this.activePhenomenon) {
                    case 'reflection':
                        // Desenhar barreira refletora
                        this.ctx.strokeStyle = '#333';
                        this.ctx.lineWidth = 4;
                        this.ctx.beginPath();
                        this.ctx.moveTo(centerX, centerY - 100);
                        this.ctx.lineTo(centerX, centerY + 100);
                        this.ctx.stroke();
                        
                        // Desenhar onda incidente e refletida
                        this.ctx.strokeStyle = this.waves[0].color;
                        this.ctx.lineWidth = 3;
                        this.ctx.beginPath();
                        
                        // Onda incidente
                        for (let x = 0; x < centerX; x += 2) {
                            const y = centerY - this.waves[0].amplitude * Math.sin(2 * Math.PI * (centerX - x) / this.waves[0].wavelength + this.waves[0].phase);
                            if (x === 0) {
                                this.ctx.moveTo(x, y);
                            } else {
                                this.ctx.lineTo(x, y);
                            }
                        }
                        
                        // Onda refletida
                        for (let x = centerX; x < this.canvas.width; x += 2) {
                            const y = centerY - this.waves[0].amplitude * Math.sin(2 * Math.PI * (x - centerX) / this.waves[0].wavelength - this.waves[0].phase);
                            this.ctx.lineTo(x, y);
                        }
                        
                        this.ctx.stroke();
                        break;
                        
                    case 'refraction':
                        // Desenhar interface entre meios
                        this.ctx.strokeStyle = '#333';
                        this.ctx.lineWidth = 2;
                        this.ctx.setLineDash([10, 5]);
                        this.ctx.beginPath();
                        this.ctx.moveTo(0, centerY);
                        this.ctx.lineTo(this.canvas.width, centerY);
                        this.ctx.stroke();
                        this.ctx.setLineDash([]);
                        
                        // Preencher meios diferentes
                        this.ctx.fillStyle = 'rgba(225, 245, 254, 0.3)';
                        this.ctx.fillRect(0, 0, this.canvas.width, centerY);
                        
                        this.ctx.fillStyle = 'rgba(255, 248, 225, 0.3)';
                        this.ctx.fillRect(0, centerY, this.canvas.width, this.canvas.height - centerY);
                        
                        // Desenhar onda refratada
                        this.ctx.strokeStyle = this.waves[0].color;
                        this.ctx.lineWidth = 3;
                        this.ctx.beginPath();
                        
                        for (let x = 0; x < this.canvas.width; x += 2) {
                            let wavelength = this.waves[0].wavelength;
                            
                            // Mudar comprimento de onda após a interface
                            if (x > centerX) {
                                wavelength *= 0.7; // Simula mudança de meio
                            }
                            
                            const y = centerY - this.waves[0].amplitude * Math.sin(2 * Math.PI * x / wavelength + this.waves[0].phase);
                            
                            if (x === 0) {
                                this.ctx.moveTo(x, y);
                            } else {
                                this.ctx.lineTo(x, y);
                            }
                        }
                        
                        this.ctx.stroke();
                        break;
                        
                    case 'diffraction':
                        // Desenhar barreira com abertura
                        this.ctx.fillStyle = '#333';
                        this.ctx.fillRect(centerX - 10, 0, 20, centerY - 50);
                        this.ctx.fillRect(centerX - 10, centerY + 50, 20, this.canvas.height - (centerY + 50));
                        
                        // Desenhar onda difratada
                        this.ctx.strokeStyle = this.waves[0].color;
                        this.ctx.lineWidth = 3;
                        
                        // Antes da abertura
                        this.ctx.beginPath();
                        for (let x = 0; x < centerX - 10; x += 2) {
                            const y = centerY - this.waves[0].amplitude * Math.sin(2 * Math.PI * x / this.waves[0].wavelength + this.waves[0].phase);
                            if (x === 0) {
                                this.ctx.moveTo(x, y);
                            } else {
                                this.ctx.lineTo(x, y);
                            }
                        }
                        this.ctx.stroke();
                        
                        // Após a abertura - ondas circulares
                        this.ctx.beginPath();
                        for (let angle = 0; angle < Math.PI * 2; angle += 0.1) {
                            const radius = 10 + (this.time * 50) % 100;
                            const x = centerX + Math.cos(angle) * radius;
                            const y = centerY + Math.sin(angle) * radius;
                            
                            if (angle === 0) {
                                this.ctx.moveTo(x, y);
                            } else {
                                this.ctx.lineTo(x, y);
                            }
                        }
                        this.ctx.stroke();
                        break;
                        
                    case 'interference':
                        // Desenhar duas fontes pontuais
                        this.ctx.fillStyle = this.waves[0].color;
                        this.ctx.beginPath();
                        this.ctx.arc(centerX - 50, centerY, 8, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        this.ctx.fillStyle = this.waves[1].color;
                        this.ctx.beginPath();
                        this.ctx.arc(centerX + 50, centerY, 8, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        // Desenhar padrão de interferência
                        const maxRadius = Math.max(this.canvas.width, this.canvas.height);
                        
                        for (let r = 10; r < maxRadius; r += 20) {
                            this.ctx.beginPath();
                            this.ctx.arc(centerX - 50, centerY, r, 0, Math.PI * 2);
                            this.ctx.strokeStyle = `rgba(255, 107, 107, ${0.5 * (1 - r/maxRadius)})`;
                            this.ctx.lineWidth = 1;
                            this.ctx.stroke();
                            
                            this.ctx.beginPath();
                            this.ctx.arc(centerX + 50, centerY, r, 0, Math.PI * 2);
                            this.ctx.strokeStyle = `rgba(78, 205, 196, ${0.5 * (1 - r/maxRadius)})`;
                            this.ctx.stroke();
                        }
                        break;
                }
            }
            
            drawLegends() {
                // Desenhar legendas das ondas
                this.ctx.font = '14px Arial';
                this.ctx.textAlign = 'left';
                
                // Onda 1
                this.ctx.fillStyle = this.waves[0].color;
                this.ctx.fillRect(20, 20, 20, 3);
                this.ctx.fillStyle = '#333';
                this.ctx.fillText(`Onda 1: ${this.waves[0].type === 'transverse' ? 'Transversal' : 'Longitudinal'}`, 50, 25);
                
                // Onda 2
                this.ctx.fillStyle = this.waves[1].color;
                this.ctx.fillRect(20, 40, 20, 3);
                this.ctx.fillStyle = '#333';
                this.ctx.fillText(`Onda 2: ${this.waves[1].type === 'transverse' ? 'Transversal' : 'Longitudinal'}`, 50, 45);
                
                // Sobreposição
                if (this.waveSuperposition) {
                    this.ctx.strokeStyle = '#9C27B0';
                    this.ctx.setLineDash([5, 5]);
                    this.ctx.beginPath();
                    this.ctx.moveTo(20, 60);
                    this.ctx.lineTo(40, 60);
                    this.ctx.stroke();
                    this.ctx.setLineDash([]);
                    
                    this.ctx.fillStyle = '#333';
                    this.ctx.fillText('Sobreposição', 50, 65);
                }
            }
            
            drawCharts() {
                this.drawAmplitudeChart();
                this.drawFrequencyChart();
                this.drawVelocityChart();
            }
            
            drawAmplitudeChart() {
                const ctx = this.amplitudeCtx;
                const width = this.amplitudeChart.width;
                const height = this.amplitudeChart.height;
                
                ctx.clearRect(0, 0, width, height);
                
                // Desenhar eixos
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(40, height - 30);
                ctx.lineTo(width - 20, height - 30);
                ctx.moveTo(40, height - 30);
                ctx.lineTo(40, 20);
                ctx.stroke();
                
                // Labels
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.fillText('Posição (px)', width / 2 - 30, height - 5);
                ctx.save();
                ctx.translate(15, height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('Amplitude (px)', -35, 0);
                ctx.restore();
                
                // Desenhar gráficos
                const colors = [this.waves[0].color, this.waves[1].color];
                
                this.waves.forEach((wave, index) => {
                    ctx.strokeStyle = colors[index];
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    
                    for (let x = 0; x < width - 60; x += 2) {
                        const realX = x * (this.canvas.width / (width - 60));
                        const y = height - 30 - (wave.amplitude * Math.sin(2 * Math.PI * realX / wave.wavelength + wave.phase) + wave.amplitude) / (2 * wave.amplitude) * (height - 50);
                        
                        if (x === 0) {
                            ctx.moveTo(40 + x, y);
                        } else {
                            ctx.lineTo(40 + x, y);
                        }
                    }
                    
                    ctx.stroke();
                });
                
                // Legenda
                ctx.font = '12px Arial';
                this.waves.forEach((wave, index) => {
                    ctx.fillStyle = colors[index];
                    ctx.fillRect(width - 120, 20 + index * 20, 10, 10);
                    ctx.fillStyle = '#333';
                    ctx.fillText(`Onda ${index + 1}`, width - 105, 30 + index * 20);
                });
            }
            
            drawFrequencyChart() {
                const ctx = this.frequencyCtx;
                const width = this.frequencyChart.width;
                const height = this.frequencyChart.height;
                
                ctx.clearRect(0, 0, width, height);
                
                // Desenhar eixos
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(40, height - 30);
                ctx.lineTo(width - 20, height - 30);
                ctx.moveTo(40, height - 30);
                ctx.lineTo(40, 20);
                ctx.stroke();
                
                // Labels
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.fillText('Frequência (Hz)', width / 2 - 30, height - 5);
                ctx.save();
                ctx.translate(15, height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('Comprimento de Onda (px)', -65, 0);
                ctx.restore();
                
                // Desenhar curva v = λ·f (velocidade constante)
                const colors = [this.waves[0].color, this.waves[1].color];
                
                this.waves.forEach((wave, index) => {
                    ctx.strokeStyle = colors[index];
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    
                    // Curva hiperbólica: λ = v/f
                    for (let f = 0.5; f <= 5; f += 0.1) {
                        const x = 40 + ((f - 0.5) / 4.5) * (width - 60);
                        const wavelength = wave.velocity / f;
                        const y = height - 30 - (wavelength / 200) * (height - 50);
                        
                        if (f === 0.5) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    
                    ctx.stroke();
                    
                    // Marcar ponto atual
                    const currentX = 40 + ((wave.frequency - 0.5) / 4.5) * (width - 60);
                    const currentY = height - 30 - (wave.wavelength / 200) * (height - 50);
                    
                    ctx.fillStyle = colors[index];
                    ctx.beginPath();
                    ctx.arc(currentX, currentY, 5, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                // Legenda
                ctx.font = '12px Arial';
                this.waves.forEach((wave, index) => {
                    ctx.fillStyle = colors[index];
                    ctx.fillRect(width - 120, 20 + index * 20, 10, 10);
                    ctx.fillStyle = '#333';
                    ctx.fillText(`Onda ${index + 1}`, width - 105, 30 + index * 20);
                });
            }
            
            drawVelocityChart() {
                const ctx = this.velocityCtx;
                const width = this.velocityChart.width;
                const height = this.velocityChart.height;
                
                ctx.clearRect(0, 0, width, height);
                
                // Desenhar eixos
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(40, height - 30);
                ctx.lineTo(width - 20, height - 30);
                ctx.moveTo(40, height - 30);
                ctx.lineTo(40, 20);
                ctx.stroke();
                
                // Labels
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.fillText('Meio', width / 2 - 15, height - 5);
                ctx.save();
                ctx.translate(15, height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText('Velocidade (px/s)', -50, 0);
                ctx.restore();
                
                // Desenhar barras para cada meio
                const media = Object.keys(this.mediumProperties);
                const barWidth = (width - 60) / media.length / 2;
                const maxVelocity = 1000; // Valor máximo para normalização
                
                media.forEach((medium, index) => {
                    const x = 40 + index * (width - 60) / media.length + barWidth / 2;
                    
                    // Desenhar barra para onda 1
                    const velocity1 = this.waves[0].wavelength * this.waves[0].frequency * this.mediumProperties[medium].velocityFactor;
                    const height1 = (velocity1 / maxVelocity) * (height - 50);
                    
                    ctx.fillStyle = this.waves[0].color;
                    ctx.fillRect(x, height - 30 - height1, barWidth * 0.8, height1);
                    
                    // Desenhar barra para onda 2
                    const velocity2 = this.waves[1].wavelength * this.waves[1].frequency * this.mediumProperties[medium].velocityFactor;
                    const height2 = (velocity2 / maxVelocity) * (height - 50);
                    
                    ctx.fillStyle = this.waves[1].color;
                    ctx.fillRect(x + barWidth, height - 30 - height2, barWidth * 0.8, height2);
                    
                    // Label do meio
                    ctx.fillStyle = '#333';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(this.mediumProperties[medium].name, x + barWidth, height - 10);
                });
                
                // Legenda
                ctx.font = '12px Arial';
                ctx.textAlign = 'left';
                this.waves.forEach((wave, index) => {
                    ctx.fillStyle = wave.color;
                    ctx.fillRect(width - 120, 20 + index * 20, 10, 10);
                    ctx.fillStyle = '#333';
                    ctx.fillText(`Onda ${index + 1}`, width - 105, 30 + index * 20);
                });
            }
            
            loadExperiment(experiment) {
                this.reset();
                
                switch(experiment) {
                    case 1:
                        // Relação entre frequência e comprimento de onda
                        // Configurar onda 1
                        this.waves[0].amplitude = 30;
                        this.waves[0].frequency = 1;
                        this.waves[0].wavelength = 200;
                        
                        // Atualizar UI
                        document.getElementById('amplitude1').value = 30;
                        document.getElementById('amplitudeValue1').textContent = 30;
                        document.getElementById('frequency1').value = 1;
                        document.getElementById('frequencyValue1').textContent = 1;
                        document.getElementById('wavelength1').value = 200;
                        document.getElementById('wavelengthValue1').textContent = 200;
                        
                        // Configurar onda 2
                        this.waves[1].amplitude = 30;
                        this.waves[1].frequency = 2;
                        this.waves[1].wavelength = 100;
                        
                        // Atualizar UI
                        document.getElementById('amplitude2').value = 30;
                        document.getElementById('amplitudeValue2').textContent = 30;
                        document.getElementById('frequency2').value = 2;
                        document.getElementById('frequencyValue2').textContent = 2;
                        document.getElementById('wavelength2').value = 100;
                        document.getElementById('wavelengthValue2').textContent = 100;
                        
                        // Mesmo meio
                        document.getElementById('medium1').value = 'air';
                        document.getElementById('medium2').value = 'air';
                        this.waves[0].medium = 'air';
                        this.waves[1].medium = 'air';
                        
                        this.showNotification('Experimento 1 carregado: Relação entre frequência e comprimento de onda', 'info');
                        break;
                    case 2:
                        // Interferência construtiva e destrutiva
                        // Configurar ondas com mesma frequência e amplitude
                        this.waves[0].amplitude = 25;
                        this.waves[0].frequency = 2;
                        this.waves[0].wavelength = 100;
                        
                        // Atualizar UI
                        document.getElementById('amplitude1').value = 25;
                        document.getElementById('amplitudeValue1').textContent = 25;
                        document.getElementById('frequency1').value = 2;
                        document.getElementById('frequencyValue1').textContent = 2;
                        document.getElementById('wavelength1').value = 100;
                        document.getElementById('wavelengthValue1').textContent = 100;
                        
                        // Configurar onda 2
                        this.waves[1].amplitude = 25;
                        this.waves[1].frequency = 2;
                        this.waves[1].wavelength = 100;
                        
                        // Atualizar UI
                        document.getElementById('amplitude2').value = 25;
                        document.getElementById('amplitudeValue2').textContent = 25;
                        document.getElementById('frequency2').value = 2;
                        document.getElementById('frequencyValue2').textContent = 2;
                        document.getElementById('wavelength2').value = 100;
                        document.getElementById('wavelengthValue2').textContent = 100;
                        
                        // Mesmo meio
                        document.getElementById('medium1').value = 'air';
                        document.getElementById('medium2').value = 'air';
                        this.waves[0].medium = 'air';
                        this.waves[1].medium = 'air';
                        
                        // Ativar sobreposição
                        document.getElementById('waveSuperposition').checked = true;
                        this.waveSuperposition = true;
                        document.getElementById('simSuperposition').textContent = 'Ativada';
                        
                        this.showNotification('Experimento 2 carregado: Interferência construtiva e destrutiva', 'info');
                        break;
                    case 3:
                        // Reflexão de ondas
                        // Configurar onda
                        this.waves[0].amplitude = 30;
                        this.waves[0].frequency = 1.5;
                        this.waves[0].wavelength = 120;
                        
                        // Atualizar UI
                        document.getElementById('amplitude1').value = 30;
                        document.getElementById('amplitudeValue1').textContent = 30;
                        document.getElementById('frequency1').value = 1.5;
                        document.getElementById('frequencyValue1').textContent = 1.5;
                        document.getElementById('wavelength1').value = 120;
                        document.getElementById('wavelengthValue1').textContent = 120;
                        
                        // Meio
                        document.getElementById('medium1').value = 'string';
                        this.waves[0].medium = 'string';
                        
                        // Ativar fenômeno de reflexão
                        document.querySelectorAll('.phenomenon-card').forEach(card => {
                            card.classList.remove('active');
                        });
                        document.querySelector('[data-phenomenon="reflection"]').classList.add('active');
                        this.activePhenomenon = 'reflection';
                        document.getElementById('simPhenomenon').textContent = 'Reflexão';
                        
                        this.showNotification('Experimento 3 carregado: Reflexão de ondas', 'info');
                        break;
                    case 4:
                        // Propagação em diferentes meios
                        // Configurar onda com parâmetros constantes
                        this.waves[0].amplitude = 25;
                        this.waves[0].frequency = 2;
                        this.waves[0].wavelength = 100;
                        
                        // Atualizar UI
                        document.getElementById('amplitude1').value = 25;
                        document.getElementById('amplitudeValue1').textContent = 25;
                        document.getElementById('frequency1').value = 2;
                        document.getElementById('frequencyValue1').textContent = 2;
                        document.getElementById('wavelength1').value = 100;
                        document.getElementById('wavelengthValue1').textContent = 100;
                        
                        // Configurar segunda onda igual
                        this.waves[1].amplitude = 25;
                        this.waves[1].frequency = 2;
                        this.waves[1].wavelength = 100;
                        
                        // Atualizar UI
                        document.getElementById('amplitude2').value = 25;
                        document.getElementById('amplitudeValue2').textContent = 25;
                        document.getElementById('frequency2').value = 2;
                        document.getElementById('frequencyValue2').textContent = 2;
                        document.getElementById('wavelength2').value = 100;
                        document.getElementById('wavelengthValue2').textContent = 100;
                        
                        // Meios diferentes
                        document.getElementById('medium1').value = 'air';
                        document.getElementById('medium2').value = 'water';
                        this.waves[0].medium = 'air';
                        this.waves[1].medium = 'water';
                        
                        this.showNotification('Experimento 4 carregado: Propagação em diferentes meios', 'info');
                        break;
                }
                
                this.updateWaveProperties();
                this.updateDisplay();
                this.draw();
                this.drawCharts();
            }
            
            showNotification(message, type = 'info') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = 'notification show';
                
                // Cor baseada no tipo
                switch(type) {
                    case 'success':
                        notification.style.background = '#48bb78';
                        break;
                    case 'error':
                        notification.style.background = '#e53e3e';
                        break;
                    case 'warning':
                        notification.style.background = '#ed8936';
                        break;
                    default:
                        notification.style.background = '#6A11CB';
                }
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 4000);
            }
        }
        
        // Inicializar simulação quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            const simulation = new WaveSimulation();
        });
    </script>
</body>
</html>
